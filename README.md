The main process code isn't pretty, this is something I spun up quickly to help out a family member.
